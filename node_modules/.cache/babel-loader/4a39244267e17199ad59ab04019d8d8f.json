{"ast":null,"code":"import _regeneratorRuntime from\"/Users/utkarsh/projects/question-selector/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/utkarsh/projects/question-selector/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/utkarsh/projects/question-selector/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/utkarsh/projects/question-selector/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/utkarsh/projects/question-selector/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/utkarsh/projects/question-selector/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/utkarsh/projects/question-selector/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{connect}from'react-redux';import{StyleSheet,css}from'aphrodite';import Button from\"../../components/atoms/Button\";import{STEPS,CONTENT_MODE,moveToNextStep,resetAll,submit}from\"../../redux/actions\";import html2canvas from\"html2canvas\";;;var DEFAULT_SCALE=1;// question_details: { title: string, hint?: string, difficulty?: string, metadata?: any, image?: string, topic_id?: number, subject_id?: number, mode?: number, options: Array<{ optionText: string, mode?: number, isCorrect: boolean }>, summary?: string, ref?: number }\nvar Dashboard=/*#__PURE__*/function(_Component){_inherits(Dashboard,_Component);function Dashboard(props){var _this;_classCallCheck(this,Dashboard);_this=_possibleConstructorReturn(this,_getPrototypeOf(Dashboard).call(this,props));_this.pdfRef=void 0;_this.subject_id=void 0;_this.topic_id=void 0;_this.difficulty=void 0;_this.metadata=void 0;_this.summary=void 0;_this.pdfRef=React.createRef();_this.state={cropping:{value:false},mousePos:{X:0,Y:0},values:{}};_this.summary=\"Empty summary\";_this.difficulty=\"easy\";_this.topic_id=19;_this.subject_id=1;_this.metadata={};return _this;}_createClass(Dashboard,[{key:\"componentDidMount\",value:function componentDidMount(){document.addEventListener(\"mousemove\",this.onMouseMove.bind(this),false);document.addEventListener(\"keydown\",this.onKeyDown.bind(this),false);document.addEventListener(\"keyup\",this.onKeyUp.bind(this),false);//  console.log(this.pdfRef.current.contentWindow.document);\n}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){if(this.props.step===STEPS.CORRECT_ANSWER){var enteredAnswer=parseInt(prompt('Which is the correct answer?'));this.moveToNextStep(enteredAnswer,CONTENT_MODE.TEXT);}if(this.props.step===STEPS.SUBMIT){// Finally submit the form.\nvar title=this.props.values[STEPS.QUESTION];var options={1:this.props.values[STEPS.ANSWER_1],2:this.props.values[STEPS.ANSWER_2],3:this.props.values[STEPS.ANSWER_3],4:this.props.values[STEPS.ANSWER_4]};var correct_answer=this.props.values[STEPS.CORRECT_ANSWER];var payload={title:this.props.values[STEPS.QUESTION].mode===CONTENT_MODE.TEXT?this.props.values[STEPS.QUESTION].content:null,mode:this.props.values[STEPS.QUESTION].mode,difficulty:this.difficulty,metadata:JSON.stringify(this.metadata),image:this.props.values[STEPS.QUESTION].mode===CONTENT_MODE.IMAGE?this.props.values[STEPS.QUESTION].content:null,topic_id:this.topic_id,subject_id:this.subject_id,summary:this.summary,options:[{optionText:options[1].content,mode:options[1].mode,isCorrect:correct_answer===1},{optionText:options[2].content,mode:options[2].mode,isCorrect:correct_answer===2},{optionText:options[3].content,mode:options[3].mode,isCorrect:correct_answer===3},{optionText:options[4].content,mode:options[4].mode,isCorrect:correct_answer===4}]};console.log(payload);var _this2=this;this.props.submit(payload);}}},{key:\"cropCanvas\",value:function cropCanvas(sourceCanvas,left,top,width,height){var destCanvas=document.createElement('canvas');destCanvas.width=width;destCanvas.height=height;destCanvas.getContext(\"2d\").drawImage(sourceCanvas,left,top,width,height,// source rect with content to crop\n0,0,width,height);// newCanvas, same size as source rect\nreturn destCanvas;}},{key:\"onMouseMove\",value:function(){var _onMouseMove=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.setState({mousePos:{X:event.clientX,Y:event.clientY}});case 1:case\"end\":return _context.stop();}}},_callee,this);}));function onMouseMove(_x){return _onMouseMove.apply(this,arguments);}return onMouseMove;}()},{key:\"onKeyUp\",value:function(){var _onKeyUp=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var width,height,style,canvas,new_canvas;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(this.state.cropping.value&&event.keyCode==16)){_context2.next=12;break;}width=Math.abs(this.state.mousePos.X-this.state.cropping.clientX);height=Math.abs(this.state.mousePos.Y-this.state.cropping.clientY);document.body.style.cursor=\"default\";style=document.getElementById(\"myStyle\");if(style){style.textContent=\"\";}_context2.next=8;return html2canvas(document.querySelector(\"body\"),{scale:DEFAULT_SCALE});case 8:canvas=_context2.sent;new_canvas=this.cropCanvas(canvas,this.state.cropping.clientX*DEFAULT_SCALE,this.state.cropping.clientY*DEFAULT_SCALE,width*DEFAULT_SCALE,height*DEFAULT_SCALE);this.moveToNextStep(new_canvas.toDataURL(\"image/png\"),CONTENT_MODE.IMAGE);this.setState({cropping:{value:false}});case 12:case\"end\":return _context2.stop();}}},_callee2,this);}));function onKeyUp(_x2){return _onKeyUp.apply(this,arguments);}return onKeyUp;}()},{key:\"moveToNextStep\",value:function moveToNextStep(content,mode){if(this.props.step!==STEPS.SUBMIT){this.props.moveToNextStep(this.props.step,{content:content,mode:mode});}}},{key:\"onKeyDown\",value:function(){var _onKeyDown=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){var key,ctrl,content,style;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"Presesd\");key=event.keyCode;ctrl=event.ctrlKey||event.metaKey;if(!(ctrl&&key==67)){_context3.next=11;break;}// ctrl + c\nconsole.log(\"LAA\");_context3.next=7;return navigator.clipboard.readText();case 7:content=_context3.sent;this.moveToNextStep(content,CONTENT_MODE.TEXT);_context3.next=12;break;case 11:if(key==16){this.setState({cropping:{value:true,clientX:this.state.mousePos.X,clientY:this.state.mousePos.Y}});// document.body.style.cursor=\"none\";\ndocument.body.style.cursor=\"crosshair\";style=document.getElementById(\"myStyle\")?document.getElementById(\"myStyle\"):document.createElement(\"style\");style.id=\"myStyle\";style.textContent=\"\\n                .textLayer > span{\\n                    cursor: crosshair;\\n                    -webkit-touch-callout: none; /* iOS Safari */\\n                    -webkit-user-select: none; /* Safari */\\n                     -khtml-user-select: none; /* Konqueror HTML */\\n                       -moz-user-select: none; /* Old versions of Firefox */\\n                        -ms-user-select: none; /* Internet Explorer/Edge */\\n                            user-select: none; /* Non-prefixed version, currently\\n                                                  supported by Chrome, Opera and Firefox */\\n                }\\n            \";if(!document.getElementById(\"myStyle\")){document.body.appendChild(style);}}case 12:case\"end\":return _context3.stop();}}},_callee3,this);}));function onKeyDown(_x3){return _onKeyDown.apply(this,arguments);}return onKeyDown;}()},{key:\"render\",value:function render(){return React.createElement(\"div\",{className:css(styles.container)},React.createElement(\"div\",{className:css(styles.stepsSection)},React.createElement(\"div\",{className:css(styles.stepsHeading)},\"Steps\"),React.createElement(\"div\",{className:css(styles.buttonsContainer)},React.createElement(Button,{text:\"Select Question\"}),React.createElement(Button,{text:\"Select Answer 1\"}),React.createElement(Button,{text:\"Select Answer 2\"}),React.createElement(Button,{text:\"Select Answer 3\"}),React.createElement(Button,{text:\"Select Answer 4\"}),React.createElement(Button,{text:\"Select Correct Answer\"}))));}}]);return Dashboard;}(Component);var styles=StyleSheet.create({container:{display:\"flex\",background:\"#fff\"},stepsSection:{flex:1,display:\"flex\",flexDirection:\"column\",alignItems:\"center\",justifyContent:\"center\",width:\"100%\",height:\"100vh\",fontSize:'1.3rem'},buttonsContainer:{},stepsHeading:{marginBottom:\"1rem\"}});var mapStateToProps=function mapStateToProps(_ref){var app=_ref.app;return{step:app.step,values:app.values};};var mapDispatchToProps={moveToNextStep:moveToNextStep,resetAll:resetAll,submit:submit};export default connect(mapStateToProps,mapDispatchToProps)(Dashboard);","map":{"version":3,"sources":["/Users/utkarsh/projects/question-selector/src/screens/dashboard/index.tsx"],"names":["React","Component","connect","StyleSheet","css","Button","STEPS","CONTENT_MODE","moveToNextStep","resetAll","submit","html2canvas","DEFAULT_SCALE","Dashboard","props","pdfRef","subject_id","topic_id","difficulty","metadata","summary","createRef","state","cropping","value","mousePos","X","Y","values","document","addEventListener","onMouseMove","bind","onKeyDown","onKeyUp","step","CORRECT_ANSWER","enteredAnswer","parseInt","prompt","TEXT","SUBMIT","title","QUESTION","options","ANSWER_1","ANSWER_2","ANSWER_3","ANSWER_4","correct_answer","payload","mode","content","JSON","stringify","image","IMAGE","optionText","isCorrect","console","log","_this","sourceCanvas","left","top","width","height","destCanvas","createElement","getContext","drawImage","event","setState","clientX","clientY","keyCode","Math","abs","body","style","cursor","getElementById","textContent","querySelector","scale","canvas","new_canvas","cropCanvas","toDataURL","key","ctrl","ctrlKey","metaKey","navigator","clipboard","readText","id","appendChild","styles","container","stepsSection","stepsHeading","buttonsContainer","create","display","background","flex","flexDirection","alignItems","justifyContent","fontSize","marginBottom","mapStateToProps","app","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { Component, Ref, RefObject, MutableRefObject } from 'react';\nimport { connect } from 'react-redux';\nimport PDFViewer from '../../components/molecules/Pdf';\nimport { StyleSheet, css } from 'aphrodite';\nimport Button from \"../../components/atoms/Button\";\nimport { STEPS, CONTENT_MODE, moveToNextStep, resetAll, submit } from \"../../redux/actions\";\nimport PDFJSBackend from \"../../backends/pdfjs\";\nimport html2canvas from \"html2canvas\";\nimport {requestAPICall} from \"../../util/network\";\n\ninterface iProps {\n\n};\ninterface iState {\n\n};\n\nconst DEFAULT_SCALE = 1;\n// question_details: { title: string, hint?: string, difficulty?: string, metadata?: any, image?: string, topic_id?: number, subject_id?: number, mode?: number, options: Array<{ optionText: string, mode?: number, isCorrect: boolean }>, summary?: string, ref?: number }\nclass Dashboard extends Component<any, any>{\n    pdfRef: any;\n    subject_id: number;\n    topic_id: number;\n    difficulty: string;\n    metadata: any;\n    summary: string;\n\n    constructor(props: iProps) {\n        super(props);\n        this.pdfRef = React.createRef();\n        this.state = {\n            cropping: {\n                value: false\n            },\n            mousePos: {\n                X: 0,\n                Y: 0\n            },\n            values: {\n\n            }\n        }\n        this.summary = \"Empty summary\";\n        this.difficulty = \"easy\";\n        this.topic_id = 19;\n        this.subject_id = 1;\n        this.metadata = {};\n    }\n\n    componentDidMount() {\n        document.addEventListener(\"mousemove\", this.onMouseMove.bind(this), false);\n        document.addEventListener(\"keydown\", this.onKeyDown.bind(this), false);\n        document.addEventListener(\"keyup\", this.onKeyUp.bind(this), false);\n        //  console.log(this.pdfRef.current.contentWindow.document);\n    }\n\n    componentDidUpdate(){\n        if(this.props.step === STEPS.CORRECT_ANSWER){\n            const enteredAnswer = parseInt(prompt('Which is the correct answer?'));\n            this.moveToNextStep(enteredAnswer, CONTENT_MODE.TEXT);\n\n        }\n        if(this.props.step === STEPS.SUBMIT){\n            // Finally submit the form.\n            const title = this.props.values[STEPS.QUESTION];\n            const options = {\n                1: this.props.values[STEPS.ANSWER_1],\n                2: this.props.values[STEPS.ANSWER_2],\n                3: this.props.values[STEPS.ANSWER_3],\n                4: this.props.values[STEPS.ANSWER_4],\n            };\n            const correct_answer = this.props.values[STEPS.CORRECT_ANSWER];\n            const payload = {\n                title: this.props.values[STEPS.QUESTION].mode === CONTENT_MODE.TEXT ?  this.props.values[STEPS.QUESTION].content : null,\n                mode: this.props.values[STEPS.QUESTION].mode,\n                difficulty: this.difficulty,\n                metadata: JSON.stringify(this.metadata),\n                image: this.props.values[STEPS.QUESTION].mode === CONTENT_MODE.IMAGE ?  this.props.values[STEPS.QUESTION].content : null,\n                topic_id: this.topic_id,\n                subject_id: this.subject_id,\n                summary: this.summary,\n                options: [\n                    {\n                        optionText: options[1].content,\n                        mode: options[1].mode,\n                        isCorrect: correct_answer === 1\n                    },\n                    {\n                        optionText: options[2].content,\n                        mode: options[2].mode,\n                        isCorrect: correct_answer === 2\n                    },\n                    {\n                        optionText: options[3].content,\n                        mode: options[3].mode,\n                        isCorrect: correct_answer === 3\n                    },\n                    {\n                        optionText: options[4].content,\n                        mode: options[4].mode,\n                        isCorrect: correct_answer === 4\n                    }\n                ]\n\n            };\n            console.log(payload);\n            const _this = this;\n            this.props.submit(payload);\n        }\n    }\n\n    cropCanvas(sourceCanvas: HTMLCanvasElement, left: number, top: number, width: number ,height:number){\n        let destCanvas = document.createElement('canvas');\n        destCanvas.width = width;\n        destCanvas.height = height;\n        destCanvas.getContext(\"2d\").drawImage(\n            sourceCanvas,\n            left,top,width,height,  // source rect with content to crop\n            0,0,width,height);      // newCanvas, same size as source rect\n        return destCanvas;\n    }\n    async onMouseMove(event: MouseEvent){\n        this.setState({mousePos: {X: event.clientX, Y: event.clientY}});\n    }\n\n    async onKeyUp(event: KeyboardEvent){\n        if(this.state.cropping.value && event.keyCode==16){\n            const width = Math.abs(this.state.mousePos.X - this.state.cropping.clientX);\n            const height = Math.abs(this.state.mousePos.Y - this.state.cropping.clientY);\n            document.body.style.cursor=\"default\";\n            const style = document.getElementById(\"myStyle\");\n\n            if(style){\n                style.textContent = \"\";\n            }\n            const canvas = await html2canvas(document.querySelector(\"body\"), {scale: DEFAULT_SCALE});\n            const new_canvas = this.cropCanvas(canvas, this.state.cropping.clientX * DEFAULT_SCALE, this.state.cropping.clientY * DEFAULT_SCALE, width * DEFAULT_SCALE, height * DEFAULT_SCALE);\n            this.moveToNextStep(new_canvas.toDataURL(\"image/png\"), CONTENT_MODE.IMAGE);\n            this.setState({cropping: {value: false}});\n        }\n    }\n\n    moveToNextStep(content: any, mode: number) {\n        if(this.props.step !== STEPS.SUBMIT){\n            this.props.moveToNextStep(this.props.step, {content, mode});\n        }\n    }\n\n    async onKeyDown(event: KeyboardEvent) {\n        console.log(\"Presesd\");\n        const key = event.keyCode;\n        const ctrl = event.ctrlKey || event.metaKey;\n        if (ctrl && key == 67) {\n            // ctrl + c\n            console.log(\"LAA\");\n            const content = await navigator.clipboard.readText();\n            this.moveToNextStep(content, CONTENT_MODE.TEXT);\n        } else if(key == 16){\n            this.setState({cropping: {value: true, clientX: this.state.mousePos.X, clientY: this.state.mousePos.Y }});\n            // document.body.style.cursor=\"none\";\n            document.body.style.cursor=\"crosshair\";\n            const style: HTMLStyleElement = document.getElementById(\"myStyle\") ? document.getElementById(\"myStyle\") as HTMLStyleElement :  document.createElement(\"style\");\n            style.id = \"myStyle\";\n            style.textContent = `\n                .textLayer > span{\n                    cursor: crosshair;\n                    -webkit-touch-callout: none; /* iOS Safari */\n                    -webkit-user-select: none; /* Safari */\n                     -khtml-user-select: none; /* Konqueror HTML */\n                       -moz-user-select: none; /* Old versions of Firefox */\n                        -ms-user-select: none; /* Internet Explorer/Edge */\n                            user-select: none; /* Non-prefixed version, currently\n                                                  supported by Chrome, Opera and Firefox */\n                }\n            `\n            if(!document.getElementById(\"myStyle\")){\n                document.body.appendChild(style);\n            }\n        }\n    }\n\n    render() {\n        return (\n            <div className={css(styles.container)}>\n                <div className={css(styles.stepsSection)}>\n                    <div className={css(styles.stepsHeading)}>Steps</div>\n                    <div className={css(styles.buttonsContainer)}>\n                        <Button text=\"Select Question\"></Button>\n                        <Button text=\"Select Answer 1\"></Button>\n                        <Button text=\"Select Answer 2\"></Button>\n                        <Button text=\"Select Answer 3\"></Button>\n                        <Button text=\"Select Answer 4\"></Button>\n                        <Button text=\"Select Correct Answer\"></Button>\n                    </div>\n\n                </div>\n            </div>\n        )\n    };\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        display: \"flex\",\n        background: \"#fff\"\n    },\n    stepsSection: {\n        flex: 1,\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        width: \"100%\",\n        height: \"100vh\",\n        fontSize: '1.3rem'\n    },\n    buttonsContainer: {\n\n    },\n    stepsHeading: {\n        marginBottom: \"1rem\"\n    }\n});\n\nconst mapStateToProps = ({ app }: any) => ({\n    step: app.step,\n    values: app.values\n});\n\nconst mapDispatchToProps = {\n    moveToNextStep,\n    resetAll,\n    submit\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps,\n)(Dashboard);"]},"metadata":{},"sourceType":"module"}